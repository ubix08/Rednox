
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RedNox - Flow Administration</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/drawflow@0.0.60/dist/drawflow.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="14" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 16L16 12L20 16L16 20L12 16Z" fill="currentColor"/>
                </svg>
                <h1>RedNox</h1>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-view="flows">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 6h14M3 10h14M3 14h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>Flows</span>
                </button>
                <button class="nav-btn" data-view="routes">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 3v14M3 10h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>Routes</span>
                </button>
                <button class="nav-btn" data-view="nodes">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="6" height="6" stroke="currentColor" stroke-width="2"/>
                        <rect x="11" y="11" width="6" height="6" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span>Nodes</span>
                </button>
            </nav>
            <div class="header-actions">
                <button class="btn-icon" id="refreshBtn" title="Refresh">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M17 10a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2"/>
                        <path d="M10 6v4l3 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button class="btn-primary" id="newFlowBtn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 5v10M5 10h10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>New Flow</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Flows View -->
        <div class="view active" id="flowsView">
            <div class="view-header">
                <h2>Flows</h2>
                <div class="stats" id="flowStats">
                    <div class="stat">
                        <span class="stat-value">-</span>
                        <span class="stat-label">Total</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">-</span>
                        <span class="stat-label">Active</span>
                    </div>
                </div>
            </div>
            <div class="flows-grid" id="flowsGrid">
                <div class="loading">Loading flows...</div>
            </div>
        </div>

        <!-- Routes View -->
        <div class="view" id="routesView">
            <div class="view-header">
                <h2>HTTP Routes</h2>
            </div>
            <div class="routes-list" id="routesList">
                <div class="loading">Loading routes...</div>
            </div>
        </div>

        <!-- Nodes View -->
        <div class="view" id="nodesView">
            <div class="view-header">
                <h2>Available Nodes</h2>
                <input type="text" id="nodeSearchInput" class="search-input" placeholder="Search nodes...">
            </div>
            <div class="nodes-categories" id="nodesCategories">
                <div class="loading">Loading nodes...</div>
            </div>
        </div>
    </main>

    <!-- Flow Editor Modal -->
    <div class="modal" id="editorModal">
        <div class="modal-content modal-fullscreen">
            <div class="modal-header">
                <div class="modal-title">
                    <input type="text" id="flowName" class="flow-name-input" placeholder="Flow Name">
                    <input type="text" id="flowDescription" class="flow-desc-input" placeholder="Description (optional)">
                    <span class="flow-status" id="flowStatus"></span>
                </div>
                <div class="modal-actions">
                    <button class="btn-secondary" id="clearFlowBtn" title="Clear Canvas">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M3 3l14 14M17 3L3 17" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <button class="btn-secondary" id="validateBtn">Validate</button>
                    <button class="btn-primary" id="saveFlowBtn">Save Flow</button>
                    <button class="btn-icon" id="closeEditorBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="editor-container">
                <div class="node-palette" id="nodePalette">
                    <div class="palette-header">Node Palette</div>
                    <div class="palette-search">
                        <input type="text" id="paletteSearch" placeholder="Search nodes...">
                    </div>
                    <div class="palette-nodes" id="paletteNodes"></div>
                </div>
                <div class="canvas-container">
                    <div class="canvas-toolbar">
                        <button class="toolbar-btn" id="zoomInBtn" title="Zoom In">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="2"/>
                                <path d="M8 5v6M5 8h6M13 13l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                        <button class="toolbar-btn" id="zoomOutBtn" title="Zoom Out">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="2"/>
                                <path d="M5 8h6M13 13l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                        <button class="toolbar-btn" id="zoomResetBtn" title="Reset Zoom">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2"/>
                                <path d="M10 6v8M6 10h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </div>
                    <div id="drawflow"></div>
                </div>
                <div class="properties-panel" id="propertiesPanel">
                    <div class="properties-header">
                        Properties
                        <button class="btn-icon btn-small" id="closePropsBtn">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M12 4L4 12M4 4l8 8" stroke="currentColor" stroke-width="2"/>
                            </svg>
                        </button>
                    </div>
                    <div class="properties-content" id="propertiesContent">
                        <div class="properties-empty">Select a node to edit properties</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="confirmTitle">Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMessage"></p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="confirmCancelBtn">Cancel</button>
                <button class="btn-danger" id="confirmOkBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Load Drawflow from CDN with fallback -->
    <script src="https://cdn.jsdelivr.net/npm/drawflow@0.0.60/dist/drawflow.min.js"></script>
    <script>
        // Check if Drawflow loaded, if not try alternative CDN
        if (typeof Drawflow === 'undefined') {
            console.log('Loading Drawflow from alternative CDN...');
            document.write('<script src="https://unpkg.com/drawflow@0.0.60/dist/drawflow.min.js"><\/script>');
        }
    </script>
    <script src="app.js"></script>
</body>
</html>
